# 转录结果查看器需求文档

## 产品概述

转录结果查看器是 EchoNote 批量转录功能的扩展，允许用户查看、编辑和管理已完成的转录结果。该功能提供直观的界面来浏览转录文本，支持多种格式导出，并完全适配应用的国际化和多主题系统。

### 核心使用场景

1. **内容审查**：用户完成批量转录后，需要查看转录结果的准确性
2. **文本编辑**：用户需要修正转录中的错误或添加注释
3. **格式转换**：用户需要将转录结果导出为不同格式（TXT、SRT、MD）
4. **快速访问**：用户需要从任务列表快速打开和查看历史转录结果

## 功能需求

### 需求 1：转录结果查看

**用户故事**：作为用户，我希望能够查看已完成转录任务的结果，以便确认转录质量并进行后续处理。

#### 验收标准

1. WHEN 用户点击已完成任务的"查看"按钮 THEN 系统应打开转录结果查看器窗口
2. WHEN 查看器打开 THEN 系统应显示完整的转录文本，包含时间戳信息（如果有）
3. WHEN 查看器显示内容 THEN 系统应使用当前应用主题（浅色/深色）的样式
4. WHEN 查看器显示内容 THEN 系统应使用当前应用语言显示所有 UI 元素
5. WHEN 转录文本较长 THEN 系统应提供流畅的滚动体验
6. WHEN 查看器打开 THEN 系统应在标题栏显示原始音频文件名
7. WHEN 查看器打开 THEN 系统应显示转录元数据：音频时长、转录语言、使用的引擎、转录完成时间
8. IF 转录结果包含时间戳 THEN 系统应以可读格式显示（例如：[00:00:15] 文本内容）
9. WHEN 用户调整窗口大小 THEN 系统应自动调整内容布局，保持可读性

### 需求 2：文本编辑功能

**用户故事**：作为用户，我希望能够编辑转录文本，以便修正识别错误或添加注释。

#### 验收标准

1. WHEN 查看器打开 THEN 系统应提供"编辑模式"切换按钮
2. WHEN 用户启用编辑模式 THEN 系统应将文本区域变为可编辑状态
3. WHEN 用户在编辑模式下修改文本 THEN 系统应实时显示修改内容
4. WHEN 用户完成编辑 THEN 系统应提供"保存"按钮
5. WHEN 用户点击"保存" THEN 系统应将修改后的内容保存到原始输出文件
6. WHEN 用户有未保存的修改并尝试关闭窗口 THEN 系统应显示确认对话框："您有未保存的修改，是否保存？"
7. WHEN 用户在编辑模式下 THEN 系统应支持标准文本编辑快捷键（Ctrl+Z 撤销、Ctrl+Y 重做、Ctrl+A 全选等）
8. WHEN 用户保存修改 THEN 系统应显示成功通知："转录结果已保存"
9. IF 保存失败 THEN 系统应显示错误信息并保留用户的编辑内容

### 需求 3：格式导出功能

**用户故事**：作为用户，我希望能够将转录结果导出为不同格式，以便在不同场景下使用。

#### 验收标准

1. WHEN 查看器打开 THEN 系统应提供"导出"下拉菜单
2. WHEN 用户点击"导出"菜单 THEN 系统应显示可用格式选项：TXT（纯文本）、SRT（字幕）、MD（Markdown）
3. WHEN 用户选择导出格式 THEN 系统应打开文件保存对话框
4. WHEN 用户选择保存位置并确认 THEN 系统应将转录结果转换为选定格式并保存
5. WHEN 导出完成 THEN 系统应显示成功通知："已导出为 [格式]"
6. WHEN 导出为 TXT THEN 系统应生成纯文本文件，不包含时间戳
7. WHEN 导出为 SRT THEN 系统应生成标准字幕格式，包含序号、时间戳和文本
8. WHEN 导出为 MD THEN 系统应生成 Markdown 格式，时间戳以代码块或引用形式显示
9. IF 导出失败 THEN 系统应显示错误信息并提供重试选项
10. WHEN 用户在编辑模式下导出 THEN 系统应导出当前编辑后的内容（无论是否已保存）

### 需求 4：文本搜索功能

**用户故事**：作为用户，我希望能够在转录文本中搜索关键词，以便快速定位特定内容。

#### 验收标准

1. WHEN 查看器打开 THEN 系统应提供搜索框（快捷键 Ctrl+F）
2. WHEN 用户输入搜索关键词 THEN 系统应实时高亮显示所有匹配项
3. WHEN 有多个匹配项 THEN 系统应显示匹配数量："第 1/5 个匹配"
4. WHEN 用户点击"下一个"按钮 THEN 系统应跳转到下一个匹配项并滚动到可见区域
5. WHEN 用户点击"上一个"按钮 THEN 系统应跳转到上一个匹配项并滚动到可见区域
6. WHEN 搜索框激活 THEN 系统应支持快捷键：Enter（下一个）、Shift+Enter（上一个）、Esc（关闭搜索）
7. WHEN 没有匹配项 THEN 系统应显示提示："未找到匹配项"
8. WHEN 用户清空搜索框 THEN 系统应移除所有高亮显示
9. WHEN 搜索功能激活 THEN 系统应支持大小写敏感选项（可选复选框）

### 需求 5：复制与分享功能

**用户故事**：作为用户，我希望能够快速复制转录文本，以便粘贴到其他应用中使用。

#### 验收标准

1. WHEN 查看器打开 THEN 系统应提供"复制全部"按钮
2. WHEN 用户点击"复制全部" THEN 系统应将完整转录文本复制到剪贴板
3. WHEN 复制完成 THEN 系统应显示临时提示："已复制到剪贴板"
4. WHEN 用户选中部分文本 THEN 系统应支持标准复制快捷键（Ctrl+C）
5. WHEN 用户右键点击文本 THEN 系统应显示上下文菜单：复制、全选
6. WHEN 复制文本 THEN 系统应保留文本格式（如果包含时间戳，也一并复制）

### 需求 6：国际化支持

**用户故事**：作为多语言用户，我希望查看器界面能够使用我选择的语言，以便更好地理解和使用功能。

#### 验收标准

1. WHEN 应用语言为中文 THEN 查看器所有 UI 元素应显示中文
2. WHEN 应用语言为英文 THEN 查看器所有 UI 元素应显示英文
3. WHEN 应用语言为法语 THEN 查看器所有 UI 元素应显示法语
4. WHEN 用户在设置中切换语言 THEN 已打开的查看器窗口应立即更新语言（无需重启）
5. WHEN 查看器显示错误消息 THEN 系统应使用当前语言显示
6. WHEN 查看器显示通知 THEN 系统应使用当前语言显示

### 需求 7：主题适配

**用户故事**：作为用户，我希望查看器能够适配我选择的主题，以便保持视觉一致性和舒适的阅读体验。

#### 验收标准

1. WHEN 应用主题为浅色 THEN 查看器应使用浅色背景和深色文字
2. WHEN 应用主题为深色 THEN 查看器应使用深色背景和浅色文字
3. WHEN 用户在设置中切换主题 THEN 已打开的查看器窗口应立即更新主题（无需重启）
4. WHEN 查看器使用深色主题 THEN 系统应确保文本对比度足够，易于阅读
5. WHEN 查看器使用浅色主题 THEN 系统应确保文本对比度足够，易于阅读
6. WHEN 搜索高亮显示 THEN 系统应使用与主题匹配的高亮颜色（浅色主题：黄色，深色主题：橙色）
7. WHEN 查看器显示按钮和控件 THEN 系统应使用与主题一致的样式

### 需求 8：窗口管理

**用户故事**：作为用户，我希望能够同时打开多个转录结果查看器，以便对比不同的转录结果。

#### 验收标准

1. WHEN 用户点击不同任务的"查看"按钮 THEN 系统应允许打开多个查看器窗口
2. WHEN 多个查看器窗口打开 THEN 系统应在任务栏显示独立的窗口图标
3. WHEN 查看器窗口打开 THEN 系统应记住窗口的位置和大小
4. WHEN 用户关闭并重新打开查看器 THEN 系统应恢复上次的窗口位置和大小
5. WHEN 用户打开同一任务的查看器 THEN 系统应将焦点切换到已打开的窗口，而不是创建新窗口
6. WHEN 查看器窗口最小化 THEN 系统应允许从任务栏恢复
7. WHEN 主应用关闭 THEN 系统应自动关闭所有打开的查看器窗口

### 需求 9：性能与响应

**用户故事**：作为用户，我希望查看器能够快速打开和流畅显示，即使转录文本很长。

#### 验收标准

1. WHEN 用户点击"查看"按钮 THEN 系统应在 1 秒内打开查看器窗口
2. WHEN 转录文本超过 10000 字 THEN 系统应使用虚拟滚动或分页加载，确保流畅性能
3. WHEN 用户滚动长文本 THEN 系统应保持 60 FPS 的流畅度
4. WHEN 用户进行搜索 THEN 系统应在 500 毫秒内完成搜索并高亮显示结果
5. WHEN 用户编辑文本 THEN 系统应无延迟地响应输入
6. WHEN 查看器加载大文件 THEN 系统应显示加载进度指示器

### 需求 10：错误处理

**用户故事**：作为用户，我希望在出现错误时能够获得清晰的提示，以便了解问题并采取行动。

#### 验收标准

1. IF 转录结果文件不存在 THEN 系统应显示错误对话框："转录文件未找到，可能已被删除或移动"
2. IF 转录结果文件无法读取 THEN 系统应显示错误对话框："无法读取转录文件，请检查文件权限"
3. IF 转录结果格式损坏 THEN 系统应显示错误对话框："转录文件格式错误，无法解析"
4. IF 保存编辑失败 THEN 系统应显示错误对话框并提供重试选项
5. IF 导出失败 THEN 系统应显示错误对话框并提供重试选项
6. WHEN 发生错误 THEN 系统应记录详细错误日志，用于故障排查
7. WHEN 显示错误对话框 THEN 系统应使用当前应用语言
